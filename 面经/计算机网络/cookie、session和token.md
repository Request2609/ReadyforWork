# cookie

cookie是一个非常具体的东西，指的是浏览器里能永久存储的一种数据，仅仅是浏览器实现的一种数据存储功能。cookie由服务器生成，发送给浏览器，浏览器把cookie以kv形式保存到某个目录下的文本文件内，下一次请求同一网站时会把该cookie发送给服务器，由于cookie是存储在客户端的，所以浏览器加入了一些限制确保cookie不会被恶意使用，同时不会占用太多磁盘空间，所以每个域的cookie数量是有限的。

# session

为了区分用户，服务器需要给每个客户端分配不同的“身份标识”，然后客户端每次向服务器发请求的时候，都带上这个“身份标识”，服务器就知道这个请求来自于谁了。至于客户端怎么保存这个“身份标识”，可以有很多种方式，对于浏览器客户端，大家都默认采用 cookie 的方式。

服务器使用session把用户的信息临时保存在了服务器上，用户离开网站后session会被销毁。这种用户信息存储方式相对cookie来说更安全，可是session有一个缺陷：如果web服务器做了负载均衡，那么下一个操作请求到了另一台服务器的时候session会丢失。

# token

HTTP协议是无状态的，这种无状态意味着程序需要验证每一次请求，从而辨别客户端的身份。而在此之前，程序都是通过在服务端存储的登录信息来辨别请求的。这种方式一般都是通过存储Session来完成。

token是服务端生成的一串字符串，以做客户端进行请求的一个令牌，第一次登陆后，服务器生成token并将token返回给客户端进行存储，以后客户端只需要带着这个token进行请求数据，不需要带上用户名密码等。最简单的token组成：uid(用户唯一的身份标识)、time(当前时间的时间戳)、sign(签名，由token的前几位+盐以哈希算法压缩成一定长的十六进制字符串，可以防止恶意第三方拼接token请求服务器)。还可以把不变的参数也放进token，避免多次查库。

# 三者区别

## cookie和session的区别

1. cookie数据放在客户端上，session数据放在服务器上；
2. cookie不是很安全，别人可以分析存放在本地的cookie并进行cookie欺骗，session的安全性更高；
3. session会在一定时间内保存在服务器上，访问增多高并发时，会比较占用服务保存器性能，因此使用cookie性能更好；
4. 单个cookie保存的数据不能超过4k，很多浏览器都限制一个站点最多保存20个cookie，session存储在服务端，根据服务器大小来定；
5. 登录等重要信息存入session，其他信息如果需要保留，可以放入cookie；

## session和token的区别

1. token是开发定义的，session是HTTP协议规定的；
2. token不一定存储，session存在服务器中；
3. token可以跨域，session不可以跨域，它是与域名绑定的；
4. 作为身份认证，token安全性比session好，因为每个请求都有签名，还能防止监听以及重放攻击，session必须靠链路层来保障通讯安全；

2. session是一种HTTP存储机制，目的是为无状态的HTTP提供的持久机制。所谓Session认证只是简单的把用户信息存储到session 里，因为SID的不可预测性，暂且可以认为是安全的。
3. token提供的是认证和授权，token是唯一的，适用于第三方共享，具有可拓展性；

## cookie和token的区别

1. token和cookie一样都是首次登陆时，由服务器下发，都是当交互时进行校验的功能，都是为无状态的HTTP提供持久机制；
2. token存在哪都行，localstorage或者cookie；
3. token只需要告诉服务器它是谁就可以；
4. token不需要去查你是谁，不要保存会话，当用户退出的时候，cookie和服务器的session都会注销，token只需要注销浏览器信息；
5. token由于服务器不存储会话，所以可扩展性强，token还可用于app中。